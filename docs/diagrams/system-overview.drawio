<mxfile host="app.diagrams.net" modified="2026-02-08T00:00:00.000Z" agent="draw.io" version="22.0.0" type="device">
  <diagram id="system-overview" name="System Overview">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1050" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="ebook-tools â€” System Overview" style="text;html=1;fontSize=20;fontStyle=1;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="30" y="10" width="400" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== USER LAYER ==================== -->
        <mxCell id="user-layer" value="Clients" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;dashed=1;dashPattern=5 5;" vertex="1" parent="1">
          <mxGeometry x="30" y="60" width="1140" height="70" as="geometry" />
        </mxCell>
        <mxCell id="browser" value="Browser&#xa;(React SPA)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="120" y="78" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ios-app" value="iOS App&#xa;(iPhone / iPad)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="280" y="78" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tvos-app" value="tvOS App&#xa;(Apple TV)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="450" y="78" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="cli" value="CLI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="610" y="78" width="80" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== DOCKER BOUNDARY ==================== -->
        <mxCell id="docker-boundary" value="Docker Compose" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#4d4d4d;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;dashed=1;dashPattern=8 4;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="30" y="155" width="850" height="570" as="geometry" />
        </mxCell>

        <!-- ==================== FRONTEND CONTAINER ==================== -->
        <mxCell id="frontend-container" value="Frontend Container (Nginx :5173)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;" vertex="1" parent="1">
          <mxGeometry x="50" y="185" width="380" height="130" as="geometry" />
        </mxCell>
        <mxCell id="spa-lib" value="Library" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="65" y="215" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="spa-narrate" value="Book&#xa;Narration" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="145" y="215" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="spa-jobs" value="Job Board" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="225" y="215" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="spa-player" value="Interactive&#xa;Player" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="305" y="215" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="spa-subs" value="Subtitles" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="65" y="260" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="spa-yt" value="YouTube&#xa;Dubbing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="145" y="260" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="spa-admin" value="Admin" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="225" y="260" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="spa-linguist" value="MyLinguist" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="305" y="260" width="80" height="30" as="geometry" />
        </mxCell>

        <!-- ==================== BACKEND CONTAINER ==================== -->
        <mxCell id="backend-container" value="Backend Container (FastAPI :8000)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;" vertex="1" parent="1">
          <mxGeometry x="50" y="340" width="820" height="120" as="geometry" />
        </mxCell>
        <mxCell id="api-auth" value="/api/auth" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="65" y="370" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-pipelines" value="/api/pipelines" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="155" y="370" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-media" value="/api/media" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="265" y="370" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-assistant" value="/api/assistant" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="355" y="370" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-admin" value="/api/admin" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="465" y="370" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-subs" value="/api/subtitles" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="555" y="370" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-sse" value="SSE Streams" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="665" y="370" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-metrics" value="/metrics" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="765" y="370" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-middle" value="JWT Auth Middleware  |  CORS  |  Config Manager  |  Prometheus Instrumentator" style="text;html=1;fontSize=10;fillColor=none;align=center;verticalAlign=middle;strokeColor=none;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="50" y="410" width="820" height="30" as="geometry" />
        </mxCell>

        <!-- ==================== PROCESSING LAYER ==================== -->
        <mxCell id="processing-layer" value="Processing Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;" vertex="1" parent="1">
          <mxGeometry x="50" y="485" width="500" height="100" as="geometry" />
        </mxCell>
        <mxCell id="pipe-orch" value="Pipeline&#xa;Orchestrator" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="65" y="515" width="95" height="40" as="geometry" />
        </mxCell>
        <mxCell id="job-mgr" value="Job Manager&#xa;(state + persistence)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="175" y="515" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="worker-pool" value="Worker Pool&#xa;(parallel rendering)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="515" width="130" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== SERVICE LAYER ==================== -->
        <mxCell id="service-layer" value="Service Backends" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;" vertex="1" parent="1">
          <mxGeometry x="50" y="610" width="820" height="100" as="geometry" />
        </mxCell>
        <mxCell id="svc-translate" value="Translation Engine&#xa;Google Translate&#xa;+ Ollama LLM fallback" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="65" y="640" width="160" height="55" as="geometry" />
        </mxCell>
        <mxCell id="svc-tts" value="TTS Engine&#xa;macOS say | gTTS | Piper" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="240" y="640" width="160" height="55" as="geometry" />
        </mxCell>
        <mxCell id="svc-align" value="WhisperX&#xa;Forced Alignment" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="415" y="640" width="130" height="55" as="geometry" />
        </mxCell>
        <mxCell id="svc-img" value="Image Generator&#xa;Draw Things /&#xa;Stable Diffusion" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="560" y="640" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="svc-resume" value="Resume &amp;&#xa;Bookmarks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="715" y="640" width="100" height="55" as="geometry" />
        </mxCell>

        <!-- ==================== MONITORING STACK ==================== -->
        <mxCell id="monitoring-boundary" value="Monitoring Stack" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#d79b00;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;dashed=1;dashPattern=8 4;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="30" y="745" width="850" height="110" as="geometry" />
        </mxCell>
        <mxCell id="prometheus" value="Prometheus&#xa;(:9090)&#xa;90d retention" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="775" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="grafana" value="Grafana&#xa;(:3000)&#xa;4 dashboards" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="280" y="775" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="pg-exporter" value="PG Exporter&#xa;(:9187)&#xa;5 custom queries" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="480" y="775" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="mon-data" value="NAS: Monitoring Data&#xa;/Volumes/Data/Monitoring/" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d79b00;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="680" y="780" width="160" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== K3S POC ==================== -->
        <mxCell id="k3s-boundary" value="k3s POC (Lima VM)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#0e7a0d;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;dashed=1;dashPattern=8 4;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="30" y="880" width="850" height="110" as="geometry" />
        </mxCell>
        <mxCell id="k3s-backend" value="Backend Pod&#xa;(:8000)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#0e7a0d;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="910" width="120" height="45" as="geometry" />
        </mxCell>
        <mxCell id="k3s-frontend" value="Frontend Pod&#xa;(:80)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#0e7a0d;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="220" y="910" width="120" height="45" as="geometry" />
        </mxCell>
        <mxCell id="k3s-postgres" value="PG StatefulSet&#xa;(:5432)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#0e7a0d;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="360" y="910" width="120" height="45" as="geometry" />
        </mxCell>
        <mxCell id="k3s-backup" value="PG Backup&#xa;CronJob" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#0e7a0d;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="500" y="910" width="120" height="45" as="geometry" />
        </mxCell>
        <mxCell id="k3s-argocd" value="Argo CD&#xa;(optional GitOps)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#0e7a0d;fontSize=11;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="910" width="130" height="45" as="geometry" />
        </mxCell>
        <mxCell id="k3s-helm" value="Helm Chart (helm/ebook-tools/)  |  Lima VM (4 CPU, 8 GB, 60 GB)  |  Traefik Ingress" style="text;html=1;fontSize=9;fillColor=none;align=center;verticalAlign=middle;strokeColor=none;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="30" y="958" width="850" height="20" as="geometry" />
        </mxCell>

        <!-- ==================== EXTERNAL SERVICES ==================== -->
        <mxCell id="ext-ollama" value="Ollama / LM Studio&#xa;(LLM endpoint)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6d0de;strokeColor=#996185;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="920" y="340" width="160" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ext-drawthings" value="Draw Things&#xa;(Stable Diffusion API)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6d0de;strokeColor=#996185;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="920" y="410" width="160" height="50" as="geometry" />
        </mxCell>

        <!-- ==================== POSTGRESQL CONTAINER ==================== -->
        <mxCell id="postgres-container" value="PostgreSQL 16 Container (:5432)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d4e1f5;strokeColor=#3a7bbf;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;" vertex="1" parent="1">
          <mxGeometry x="470" y="185" width="400" height="100" as="geometry" />
        </mxCell>
        <mxCell id="pg-users" value="users&#xa;sessions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#3a7bbf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="485" y="215" width="70" height="35" as="geometry" />
        </mxCell>
        <mxCell id="pg-library" value="library&#xa;(tsvector FTS)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#3a7bbf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="565" y="215" width="85" height="35" as="geometry" />
        </mxCell>
        <mxCell id="pg-config" value="config&#xa;(6 tables)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#3a7bbf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="660" y="215" width="75" height="35" as="geometry" />
        </mxCell>
        <mxCell id="pg-bookmarks" value="bookmarks&#xa;resume" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#3a7bbf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="745" y="215" width="75" height="35" as="geometry" />
        </mxCell>
        <mxCell id="pg-meta" value="SQLAlchemy 2.0 + Alembic  |  14 tables  |  JSONB + GIN indexes" style="text;html=1;fontSize=9;fillColor=none;align=center;verticalAlign=middle;strokeColor=none;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="470" y="255" width="400" height="20" as="geometry" />
        </mxCell>

        <!-- ==================== STORAGE LAYER ==================== -->
        <mxCell id="storage-layer" value="Storage" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=1;fontSize=12;verticalAlign=top;spacingTop=4;" vertex="1" parent="1">
          <mxGeometry x="580" y="485" width="290" height="100" as="geometry" />
        </mxCell>
        <mxCell id="fs-jobs" value="storage/jobs/&#xa;(metadata, audio,&#xa;images, exports)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#666666;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="595" y="510" width="120" height="55" as="geometry" />
        </mxCell>
        <mxCell id="nas-mount" value="NAS Mounts&#xa;(ebooks, videos,&#xa;subtitles)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#666666;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="730" y="510" width="120" height="55" as="geometry" />
        </mxCell>

        <!-- ==================== PG BACKUP SIDECAR ==================== -->
        <mxCell id="pg-backup" value="pg-backup&#xa;(daily dump,&#xa;7-day retention)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d4e1f5;strokeColor=#3a7bbf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="920" y="275" width="120" height="50" as="geometry" />
        </mxCell>

        <!-- ==================== PG NAS STORAGE ==================== -->
        <mxCell id="pg-nas-data" value="NAS: PG Data&#xa;/Volumes/Data/&#xa;Databases/" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#3a7bbf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="920" y="485" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="pg-nas-backup" value="NAS: PG Backups&#xa;/Volumes/Backups/" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#3a7bbf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="920" y="545" width="120" height="45" as="geometry" />
        </mxCell>

        <!-- ==================== TLS TERMINATION ==================== -->
        <mxCell id="synology" value="Synology DSM&#xa;Reverse Proxy&#xa;(TLS :443)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6d0de;strokeColor=#996185;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="920" y="185" width="160" height="60" as="geometry" />
        </mxCell>

        <!-- ==================== ARROWS ==================== -->
        <!-- Clients to Synology -->
        <mxCell id="a1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4d4d4d;strokeWidth=1.5;exitX=0.5;exitY=1;entryX=0;entryY=0.5;" edge="1" source="browser" target="synology" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Synology to Frontend -->
        <mxCell id="a2" value="HTTPS" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4d4d4d;strokeWidth=1.5;fontSize=9;fontColor=#666;" edge="1" source="synology" target="frontend-container" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Frontend proxy to Backend -->
        <mxCell id="a3" value="proxy /api/, /pipelines/, /storage/" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#6c8ebf;strokeWidth=1.5;fontSize=9;fontColor=#666;" edge="1" source="frontend-container" target="backend-container" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- iOS direct to Backend -->
        <mxCell id="a4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4d4d4d;strokeWidth=1.5;" edge="1" source="ios-app" target="synology" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Backend to Processing -->
        <mxCell id="a5" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d6b656;strokeWidth=1.5;" edge="1" source="backend-container" target="processing-layer" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Processing to Services -->
        <mxCell id="a6" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#b85450;strokeWidth=1.5;" edge="1" source="processing-layer" target="service-layer" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Processing to Storage -->
        <mxCell id="a7" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#666666;strokeWidth=1.5;" edge="1" source="processing-layer" target="storage-layer" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Backend to External: Ollama -->
        <mxCell id="a8" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#996185;strokeWidth=1.5;dashed=1;" edge="1" source="backend-container" target="ext-ollama" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Backend to External: Draw Things -->
        <mxCell id="a9" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#996185;strokeWidth=1.5;dashed=1;" edge="1" source="backend-container" target="ext-drawthings" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Backend to PostgreSQL -->
        <mxCell id="a10" value="SQLAlchemy" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#3a7bbf;strokeWidth=1.5;fontSize=9;fontColor=#666;" edge="1" source="backend-container" target="postgres-container" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- PostgreSQL to NAS data -->
        <mxCell id="a11" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#3a7bbf;strokeWidth=1.5;" edge="1" source="postgres-container" target="pg-nas-data" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- pg-backup to PostgreSQL -->
        <mxCell id="a12" value="pg_dump" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#3a7bbf;strokeWidth=1.5;dashed=1;fontSize=9;fontColor=#666;" edge="1" source="pg-backup" target="postgres-container" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- pg-backup to NAS backups -->
        <mxCell id="a13" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#3a7bbf;strokeWidth=1.5;dashed=1;" edge="1" source="pg-backup" target="pg-nas-backup" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Monitoring: Backend /metrics to Prometheus -->
        <mxCell id="a14" value="scrape 10s" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d79b00;strokeWidth=1.5;fontSize=9;fontColor=#666;" edge="1" source="api-metrics" target="prometheus" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Monitoring: PG Exporter to PostgreSQL -->
        <mxCell id="a15" value="scrape 30s" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d79b00;strokeWidth=1.5;fontSize=9;fontColor=#666;" edge="1" source="pg-exporter" target="postgres-container" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Monitoring: PG Exporter to Prometheus -->
        <mxCell id="a16" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d79b00;strokeWidth=1.5;" edge="1" source="pg-exporter" target="prometheus" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Monitoring: Prometheus to Grafana -->
        <mxCell id="a17" value="query" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d79b00;strokeWidth=1.5;fontSize=9;fontColor=#666;" edge="1" source="prometheus" target="grafana" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Monitoring: Prometheus to data -->
        <mxCell id="a18" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d79b00;strokeWidth=1.5;dashed=1;" edge="1" source="prometheus" target="mon-data" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- k3s: Prometheus scrapes k3s backend via port-forward -->
        <mxCell id="a19" value="port-forward :18000" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#0e7a0d;strokeWidth=1.5;dashed=1;fontSize=9;fontColor=#666;" edge="1" source="prometheus" target="k3s-backend" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
